import { Router } from "express";
import middlewareHandler from "../../src/middlewares/_middleware.js";
import control from "../../src/utils/control.js";
import sanitizeAndValidate from "../../src/validations/_validate.js";
import authController from "../../src/controllers/authController.js";
import authValidation from "../../src/validations/authValidation.js";
const router = Router();
router.post("/signup", middlewareHandler("guest"), sanitizeAndValidate(authValidation.signup), control(authController.signup));
router.post("/signin", middlewareHandler("guest"), sanitizeAndValidate(authValidation.signin), control(authController.signin));
router.get("/refresh", control(authController.refresh));
router.patch("/change-password", middlewareHandler("auth"), sanitizeAndValidate(authValidation.changePassword), control(authController.changePassword));
router.patch("/reset-password", middlewareHandler("guest"), sanitizeAndValidate(authValidation.resetPassword), control(authController.resetPassword));
export default router;
